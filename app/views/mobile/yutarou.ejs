<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no,initial-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <link rel="stylesheet" href="/css/bootstrap.css" />
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
	<script src="js/jquery-1.7.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
	<script src="js/klass.min.js"></script>
	<script src="js/code.photoswipe.jquery-3.0.5.js"></script>
    <script type="text/javascript">
      var socket = io.connect();
      var imageHtml = function( imagePath ) {
        var url = '/getImage?imagePath=' + imagePath;
      	var element = [
             '<li>',
	     	 '<a href="' + url + '" class="thumbnail">',
             '<img  src="' + url + '" />',
             '</a>',
             '</li>'
          ].join('');
      	return element;
      };
      var addImage = function( imagePath ) {
          var element = imageHtml( imagePath )
          $("#imageContainer").append(element);
      };
      
      var getImages = function() {
        $.get( '/yutarou/images', function(data) {
           for( var i = 0; i < data.length; i++ ) {
             var file = data[i];
             addImage( 'uploadimages/yutaro/' + file );
           }
          var options = {};
          $("#imageContainer a").photoSwipe(options);

        } );
      };
      
      $(function() {
        getImages();
      });
      
      socket.on('uploaded', function(data){
      	addImage( data.imagePath );
      });
    </script>
    <title>ChildSmile</title>
  </head>
  <body>

	<div data-role="page">
		<div data-role="header">
			<h1>優太郎くんの写真</h1>
		</div><!-- /header -->
		<div data-role="content">
		  <ul class="thumbnails" id="imageContainer">
		  </ul>
		</div><!-- /content -->
	</div>
	
  </body>
</html>

